%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Sun Jun 14 19:15:14 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (51)
} def

/sequence { (\
GGAAAAACAGCGCAAUGAAAACAUUGGGAAGUAUGGAAAACCAUAGAACAAAAGUUCACAACCCGCUGCCCUCGAUUCGUCGAGGGAAAAGAAACAACAACAACAAC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 8 0.043300443 ubox
1 42 0.003328429 ubox
1 59 0.010235012 ubox
1 62 0.004834080 ubox
1 63 0.046127133 ubox
1 64 0.108618813 ubox
1 66 0.005187432 ubox
1 67 0.009092791 ubox
1 95 0.070242691 ubox
1 98 0.070756339 ubox
1 101 0.072245411 ubox
1 104 0.072593268 ubox
1 107 0.018328011 ubox
2 8 0.010276920 ubox
2 11 0.003479303 ubox
2 41 0.003324594 ubox
2 59 0.005280697 ubox
2 62 0.046212444 ubox
2 63 0.108425111 ubox
2 64 0.007546291 ubox
2 66 0.009638271 ubox
2 69 0.003809790 ubox
2 95 0.037051568 ubox
2 98 0.037188103 ubox
2 101 0.037947573 ubox
2 104 0.037805669 ubox
2 107 0.012336102 ubox
5 34 0.004295917 ubox
6 32 0.005905902 ubox
7 32 0.082593239 ubox
8 17 0.007267929 ubox
8 31 0.104306341 ubox
8 65 0.003722744 ubox
8 68 0.982297795 ubox
8 91 0.008741574 ubox
9 16 0.007143511 ubox
9 67 0.987142880 ubox
10 59 0.004557376 ubox
10 62 0.003250766 ubox
10 66 0.987918320 ubox
10 95 0.009959674 ubox
10 98 0.009784528 ubox
10 101 0.009899170 ubox
10 104 0.009939263 ubox
10 107 0.003471525 ubox
11 27 0.015765399 ubox
11 28 0.162987811 ubox
11 65 0.985866295 ubox
12 22 0.004224623 ubox
12 59 0.006970364 ubox
12 62 0.019451089 ubox
12 63 0.042816029 ubox
12 64 0.942486788 ubox
12 66 0.005236390 ubox
13 17 0.004601921 ubox
13 26 0.958622229 ubox
13 27 0.045727811 ubox
13 28 0.013174035 ubox
13 31 0.004831086 ubox
13 65 0.005246076 ubox
14 25 0.965214801 ubox
15 24 0.966218841 ubox
15 25 0.004953834 ubox
16 21 0.007106253 ubox
16 23 0.966291693 ubox
16 27 0.005363723 ubox
16 58 0.125727103 ubox
16 60 0.190186321 ubox
16 61 0.010023631 ubox
17 22 0.960759371 ubox
17 25 0.006462058 ubox
17 57 0.130428466 ubox
17 59 0.195876366 ubox
17 63 0.004238361 ubox
18 24 0.006506138 ubox
18 25 0.009673802 ubox
18 56 0.128653546 ubox
19 24 0.008373572 ubox
19 25 0.005074816 ubox
19 55 0.120384218 ubox
19 56 0.016048416 ubox
20 24 0.004107063 ubox
20 25 0.003560029 ubox
20 55 0.018652855 ubox
20 56 0.197821222 ubox
21 32 0.012217097 ubox
21 55 0.206752445 ubox
21 56 0.003246200 ubox
22 26 0.004613960 ubox
22 27 0.011971646 ubox
22 28 0.007316293 ubox
22 31 0.015466198 ubox
22 35 0.003304424 ubox
22 54 0.207788136 ubox
22 68 0.015704175 ubox
23 32 0.008445281 ubox
23 34 0.003340028 ubox
23 55 0.008518655 ubox
23 67 0.015688680 ubox
24 30 0.003407882 ubox
24 31 0.010760892 ubox
24 33 0.003321085 ubox
24 50 0.005127303 ubox
24 51 0.154109340 ubox
24 52 0.108109730 ubox
24 53 0.109176029 ubox
24 54 0.009574109 ubox
24 61 0.005145986 ubox
25 29 0.003226804 ubox
25 30 0.012337177 ubox
25 43 0.009415861 ubox
25 50 0.166169281 ubox
25 51 0.097593330 ubox
25 52 0.109532235 ubox
25 53 0.010666198 ubox
25 60 0.006163784 ubox
25 65 0.017569616 ubox
26 42 0.011722228 ubox
26 49 0.167941302 ubox
26 59 0.006646114 ubox
26 63 0.024636008 ubox
26 64 0.095260008 ubox
27 32 0.028436384 ubox
27 34 0.004814465 ubox
27 41 0.012157283 ubox
27 42 0.024119070 ubox
27 49 0.113949102 ubox
27 57 0.014495971 ubox
27 59 0.025482195 ubox
27 62 0.030578955 ubox
27 63 0.211814057 ubox
27 64 0.101282141 ubox
28 32 0.009156449 ubox
28 41 0.024061422 ubox
28 49 0.100809585 ubox
28 56 0.014459097 ubox
28 57 0.015433958 ubox
28 59 0.016119252 ubox
28 62 0.211453716 ubox
28 63 0.102260684 ubox
28 64 0.007015041 ubox
29 34 0.003350733 ubox
29 44 0.004062805 ubox
29 55 0.014293322 ubox
29 56 0.015334189 ubox
30 44 0.005197669 ubox
30 55 0.013916297 ubox
30 67 0.007097796 ubox
31 41 0.008243417 ubox
31 44 0.009794315 ubox
31 49 0.011924644 ubox
31 59 0.101895684 ubox
31 62 0.022826528 ubox
31 63 0.010783263 ubox
31 64 0.004282884 ubox
31 66 0.007333279 ubox
31 95 0.007688819 ubox
31 98 0.007705687 ubox
31 101 0.007796555 ubox
31 104 0.007773875 ubox
32 37 0.007460333 ubox
32 39 0.003732701 ubox
32 40 0.008215444 ubox
32 43 0.006553746 ubox
32 45 0.932178334 ubox
32 46 0.005677707 ubox
32 48 0.009671458 ubox
32 53 0.010711744 ubox
32 58 0.075429234 ubox
32 60 0.003511657 ubox
32 61 0.018267646 ubox
32 65 0.005950434 ubox
32 94 0.006087473 ubox
32 97 0.006108726 ubox
32 100 0.006183542 ubox
32 103 0.006165349 ubox
33 44 0.989665664 ubox
34 39 0.003798232 ubox
34 43 0.996567946 ubox
34 45 0.004446809 ubox
35 41 0.011859812 ubox
35 42 0.999098312 ubox
35 44 0.004422123 ubox
36 41 0.992921423 ubox
36 42 0.007017281 ubox
44 58 0.010989849 ubox
44 60 0.004473320 ubox
44 61 0.003807765 ubox
46 56 0.005347946 ubox
46 57 0.965211343 ubox
46 59 0.011561426 ubox
47 55 0.004758217 ubox
47 56 0.966100392 ubox
48 55 0.965549597 ubox
49 54 0.964121683 ubox
54 59 0.010890810 ubox
54 62 0.034660142 ubox
54 63 0.007405377 ubox
54 101 0.006147670 ubox
55 61 0.034387197 ubox
55 100 0.006112694 ubox
56 60 0.028676830 ubox
56 99 0.005538040 ubox
59 65 0.013851214 ubox
59 68 0.025172681 ubox
60 67 0.023648291 ubox
62 68 0.004307288 ubox
62 91 0.005292996 ubox
63 68 0.003383856 ubox
63 91 0.012959567 ubox
64 91 0.058049927 ubox
65 95 0.005936523 ubox
65 98 0.006886494 ubox
65 101 0.005400825 ubox
65 104 0.004352515 ubox
66 91 0.059962879 ubox
67 87 0.021488197 ubox
67 88 0.029061791 ubox
67 89 0.015755067 ubox
67 90 0.057359134 ubox
67 96 0.009838228 ubox
67 99 0.007644672 ubox
67 102 0.006112222 ubox
67 105 0.004272364 ubox
68 95 0.010672623 ubox
68 98 0.008295908 ubox
68 101 0.006635088 ubox
68 104 0.004798543 ubox
69 85 0.004927061 ubox
69 86 0.996665402 ubox
70 84 0.003503168 ubox
70 85 0.999947845 ubox
70 86 0.005549437 ubox
71 84 0.999973416 ubox
71 85 0.004145195 ubox
72 83 0.999847281 ubox
73 82 0.999968051 ubox
74 81 0.998118628 ubox
75 80 0.884644658 ubox
86 95 0.007222530 ubox
91 95 0.042960353 ubox
91 98 0.103498381 ubox
91 101 0.045368422 ubox
91 104 0.035081841 ubox
91 107 0.010378790 ubox
8 68 0.9500000 lbox
9 67 0.9500000 lbox
10 66 0.9500000 lbox
11 65 0.9500000 lbox
12 64 0.9500000 lbox
13 26 0.9500000 lbox
14 25 0.9500000 lbox
15 24 0.9500000 lbox
16 23 0.9500000 lbox
17 22 0.9500000 lbox
32 45 0.9500000 lbox
33 44 0.9500000 lbox
34 43 0.9500000 lbox
35 42 0.9500000 lbox
36 41 0.9500000 lbox
46 57 0.9500000 lbox
47 56 0.9500000 lbox
48 55 0.9500000 lbox
49 54 0.9500000 lbox
69 86 0.9500000 lbox
70 85 0.9500000 lbox
71 84 0.9500000 lbox
72 83 0.9500000 lbox
73 82 0.9500000 lbox
74 81 0.9500000 lbox
75 80 0.9500000 lbox
showpage
end
%%EOF
