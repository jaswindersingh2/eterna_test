%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Sun Jun 14 19:14:51 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (1039)
} def

/sequence { (\
GGAAACGCGUAACGCAACCAGUAUCUGGAACCCUCAACGAGGGAAGGUCAUAGACCACGGCACAGCCAGGUCUGCUUCGGCAGACCAAAAGAAACAACAACAACAAC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 6 0.122004598 ubox
1 8 0.054856858 ubox
1 13 0.012098659 ubox
1 15 0.006869757 ubox
1 18 0.007912879 ubox
1 19 0.181007924 ubox
1 26 0.024316663 ubox
1 56 0.017164610 ubox
1 58 0.086065100 ubox
1 61 0.007549957 ubox
1 63 0.011698249 ubox
1 66 0.005844774 ubox
1 67 0.155330372 ubox
1 86 0.022711679 ubox
1 95 0.374690425 ubox
1 98 0.370934502 ubox
1 101 0.377576145 ubox
1 104 0.379475981 ubox
1 107 0.095796428 ubox
2 6 0.073625148 ubox
2 8 0.025669398 ubox
2 13 0.008217040 ubox
2 15 0.009202169 ubox
2 18 0.180931162 ubox
2 19 0.014434427 ubox
2 25 0.028795231 ubox
2 49 0.003955204 ubox
2 55 0.016704165 ubox
2 56 0.004200027 ubox
2 58 0.054764257 ubox
2 61 0.007332686 ubox
2 63 0.006020788 ubox
2 66 0.154879592 ubox
2 67 0.010992106 ubox
2 85 0.015511861 ubox
2 86 0.012960230 ubox
2 95 0.198476540 ubox
2 98 0.193436164 ubox
2 101 0.197451598 ubox
2 104 0.196721412 ubox
2 107 0.064184685 ubox
3 10 0.005117146 ubox
3 24 0.028482652 ubox
3 48 0.003705870 ubox
4 10 0.005178553 ubox
5 10 0.003668072 ubox
5 22 0.029438720 ubox
5 48 0.003643179 ubox
6 14 0.092560307 ubox
6 21 0.029897600 ubox
6 27 0.004233823 ubox
6 47 0.003894121 ubox
6 53 0.003317585 ubox
6 59 0.022558243 ubox
6 60 0.021436847 ubox
6 65 0.015257005 ubox
6 69 0.006555939 ubox
6 91 0.213937791 ubox
7 13 0.093009237 ubox
7 15 0.956089350 ubox
7 19 0.012040891 ubox
7 22 0.004965971 ubox
7 26 0.004067824 ubox
7 58 0.013047578 ubox
7 61 0.087949100 ubox
7 63 0.011926997 ubox
7 66 0.078678104 ubox
7 67 0.008611221 ubox
7 95 0.027632680 ubox
7 98 0.030767379 ubox
7 101 0.029422536 ubox
7 104 0.029190368 ubox
7 107 0.011059105 ubox
8 14 0.957271997 ubox
8 21 0.005077418 ubox
8 59 0.074809335 ubox
8 60 0.078041040 ubox
8 65 0.079073336 ubox
8 91 0.031541011 ubox
9 13 0.895592971 ubox
9 15 0.057982358 ubox
9 18 0.023744161 ubox
9 24 0.004479519 ubox
9 25 0.003957882 ubox
9 58 0.086881125 ubox
9 61 0.013403375 ubox
9 63 0.079265216 ubox
9 66 0.009335855 ubox
9 95 0.091874136 ubox
9 98 0.087161518 ubox
9 101 0.086907815 ubox
9 104 0.086380731 ubox
9 107 0.032762271 ubox
10 14 0.054300911 ubox
10 16 0.004649019 ubox
10 17 0.023778712 ubox
10 23 0.004693492 ubox
10 57 0.082828581 ubox
10 59 0.005175755 ubox
10 60 0.013045380 ubox
10 62 0.079420448 ubox
10 65 0.009199242 ubox
10 87 0.006408535 ubox
10 88 0.006513615 ubox
10 89 0.007979807 ubox
10 90 0.007018859 ubox
10 91 0.005710759 ubox
10 92 0.008548187 ubox
10 93 0.007169827 ubox
10 94 0.088911800 ubox
10 96 0.006519226 ubox
10 97 0.084196969 ubox
10 99 0.005847295 ubox
10 100 0.083943756 ubox
10 102 0.005703332 ubox
10 103 0.083431498 ubox
10 105 0.004739179 ubox
10 106 0.031917501 ubox
11 22 0.003525980 ubox
12 22 0.010483595 ubox
13 21 0.011239438 ubox
13 59 0.082597693 ubox
13 60 0.004181979 ubox
13 91 0.037833259 ubox
14 22 0.007065808 ubox
14 31 0.003250335 ubox
14 58 0.081329314 ubox
14 61 0.024524626 ubox
14 66 0.008946408 ubox
14 95 0.026615202 ubox
14 98 0.026472041 ubox
14 101 0.025825974 ubox
14 104 0.023142290 ubox
14 107 0.008586909 ubox
15 21 0.007339141 ubox
15 27 0.003358749 ubox
15 59 0.004718635 ubox
15 60 0.024493775 ubox
15 65 0.008978060 ubox
15 91 0.037884255 ubox
16 26 0.003260657 ubox
18 27 0.007353756 ubox
18 28 0.966459551 ubox
18 91 0.007342807 ubox
19 27 0.970917645 ubox
19 28 0.009728768 ubox
19 91 0.005462670 ubox
20 26 0.968550385 ubox
21 25 0.947326627 ubox
21 26 0.005155260 ubox
21 58 0.006638622 ubox
21 95 0.208235397 ubox
21 98 0.029332424 ubox
21 101 0.032788791 ubox
21 104 0.033089148 ubox
21 107 0.011626716 ubox
22 57 0.006399466 ubox
22 93 0.007330060 ubox
22 94 0.205591468 ubox
22 96 0.004013153 ubox
22 97 0.028288518 ubox
22 100 0.031841656 ubox
22 103 0.032137904 ubox
22 106 0.011411255 ubox
24 54 0.007815467 ubox
24 92 0.214144392 ubox
24 93 0.005894860 ubox
25 53 0.008355341 ubox
25 60 0.003173727 ubox
25 65 0.004077196 ubox
25 69 0.004153086 ubox
25 91 0.217716184 ubox
26 52 0.008299149 ubox
26 59 0.003213138 ubox
26 64 0.004149249 ubox
26 68 0.008590636 ubox
26 88 0.003308181 ubox
26 89 0.009894834 ubox
26 90 0.210889042 ubox
26 96 0.031484305 ubox
26 99 0.031469100 ubox
26 102 0.026284270 ubox
26 105 0.023556770 ubox
27 49 0.003346820 ubox
27 51 0.007968383 ubox
27 58 0.007542625 ubox
27 63 0.004167477 ubox
27 67 0.009911016 ubox
27 95 0.033566997 ubox
27 98 0.033555370 ubox
27 101 0.028499857 ubox
27 104 0.025932153 ubox
27 107 0.003287867 ubox
28 48 0.003297128 ubox
28 49 0.005954624 ubox
28 58 0.005534820 ubox
28 66 0.009855139 ubox
28 95 0.009438208 ubox
28 98 0.009189547 ubox
28 101 0.008586466 ubox
28 104 0.008244313 ubox
29 48 0.005484900 ubox
30 48 0.006453763 ubox
31 42 0.021605853 ubox
31 43 0.993518177 ubox
31 47 0.006839666 ubox
31 91 0.004138453 ubox
32 41 0.021122377 ubox
32 42 0.998115881 ubox
32 43 0.049820776 ubox
32 46 0.006769166 ubox
33 39 0.012759305 ubox
33 41 0.998137259 ubox
33 42 0.049767448 ubox
33 43 0.024536351 ubox
34 39 0.017466350 ubox
34 40 0.992589524 ubox
34 41 0.045715179 ubox
34 42 0.024615098 ubox
34 44 0.005572987 ubox
35 39 0.918640378 ubox
35 41 0.027607837 ubox
35 42 0.003240163 ubox
35 43 0.005727713 ubox
43 58 0.013765769 ubox
46 55 0.007985111 ubox
46 56 0.998254773 ubox
46 58 0.008273054 ubox
46 63 0.005087364 ubox
46 67 0.004974189 ubox
46 86 0.006954383 ubox
47 55 0.999335813 ubox
47 56 0.005118308 ubox
47 58 0.010600441 ubox
47 61 0.008672635 ubox
47 66 0.004975779 ubox
47 85 0.006961571 ubox
48 53 0.008311132 ubox
48 54 0.998573060 ubox
48 57 0.010457242 ubox
48 60 0.008683024 ubox
48 65 0.004691490 ubox
48 84 0.006959186 ubox
49 53 0.990168974 ubox
49 59 0.008671292 ubox
49 83 0.006947741 ubox
52 73 0.005670570 ubox
53 58 0.003692850 ubox
53 72 0.007171333 ubox
54 71 0.007202660 ubox
55 70 0.007221281 ubox
56 69 0.007222576 ubox
58 65 0.045670881 ubox
58 69 0.018271822 ubox
58 91 0.018535020 ubox
59 63 0.010129453 ubox
59 66 0.018842104 ubox
59 67 0.980518902 ubox
59 95 0.006040666 ubox
59 98 0.003356596 ubox
60 66 0.981580856 ubox
60 67 0.007560677 ubox
60 95 0.004242036 ubox
61 65 0.974472311 ubox
63 91 0.004362375 ubox
66 91 0.004777374 ubox
67 91 0.005293026 ubox
69 86 0.998349317 ubox
70 85 0.999823078 ubox
71 84 0.999822184 ubox
72 83 0.999957233 ubox
73 82 0.999737407 ubox
74 81 0.999980956 ubox
75 79 0.011548369 ubox
75 80 0.999159430 ubox
76 80 0.003704663 ubox
86 91 0.010812955 ubox
91 95 0.067253400 ubox
91 98 0.136495258 ubox
91 101 0.045187906 ubox
91 104 0.015980295 ubox
91 107 0.003969684 ubox
1 95 0.9500000 lbox
7 15 0.9500000 lbox
8 14 0.9500000 lbox
9 13 0.9500000 lbox
18 28 0.9500000 lbox
19 27 0.9500000 lbox
20 26 0.9500000 lbox
21 25 0.9500000 lbox
31 43 0.9500000 lbox
32 42 0.9500000 lbox
33 41 0.9500000 lbox
34 40 0.9500000 lbox
35 39 0.9500000 lbox
46 56 0.9500000 lbox
47 55 0.9500000 lbox
48 54 0.9500000 lbox
49 53 0.9500000 lbox
59 67 0.9500000 lbox
60 66 0.9500000 lbox
61 65 0.9500000 lbox
69 86 0.9500000 lbox
70 85 0.9500000 lbox
71 84 0.9500000 lbox
72 83 0.9500000 lbox
73 82 0.9500000 lbox
74 81 0.9500000 lbox
75 80 0.9500000 lbox
showpage
end
%%EOF
