%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Mon Jun 15 13:50:48 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (187)
} def

/sequence { (\
GGAAAUGCGCUGUCCGGCUUCCGUGCGCGGCAAGCUAGACCGUCGACUGGUGUCACGGAGGACUUCGCAAGCGUUUUCG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 72 0.019534966 ubox
1 74 0.004239675 ubox
1 75 0.004059267 ubox
1 76 0.007553477 ubox
1 77 0.007886631 ubox
1 78 0.937013882 ubox
2 72 0.014567827 ubox
2 74 0.005777271 ubox
2 75 0.011225935 ubox
2 76 0.011817828 ubox
2 77 0.939579723 ubox
2 78 0.325235015 ubox
3 74 0.011533757 ubox
3 75 0.012492872 ubox
3 76 0.940275217 ubox
3 77 0.323625320 ubox
4 74 0.010828281 ubox
4 75 0.938341939 ubox
4 76 0.319126305 ubox
4 77 0.030924161 ubox
5 74 0.931490648 ubox
5 75 0.283317096 ubox
5 76 0.038893998 ubox
5 77 0.003400618 ubox
6 69 0.236336802 ubox
6 70 0.015134107 ubox
6 71 0.006093334 ubox
6 73 0.908608131 ubox
7 68 0.294602771 ubox
7 72 0.893136449 ubox
7 74 0.325119938 ubox
7 75 0.004585736 ubox
8 67 0.298897916 ubox
8 71 0.889299410 ubox
8 73 0.338873069 ubox
9 18 0.003510991 ubox
9 28 0.006035288 ubox
9 31 0.014415898 ubox
9 35 0.039966290 ubox
9 41 0.004861854 ubox
9 43 0.017986037 ubox
9 44 0.005511692 ubox
9 64 0.003494168 ubox
9 65 0.011730320 ubox
9 66 0.319045258 ubox
9 68 0.681000898 ubox
9 72 0.339669468 ubox
10 17 0.003674051 ubox
10 27 0.005908330 ubox
10 30 0.014432278 ubox
10 34 0.040029795 ubox
10 42 0.019535668 ubox
10 67 0.683151713 ubox
10 71 0.339693420 ubox
11 16 0.003449245 ubox
11 29 0.014420663 ubox
11 32 0.021277533 ubox
11 33 0.034401887 ubox
11 61 0.004167008 ubox
11 67 0.041560597 ubox
11 69 0.548647406 ubox
11 70 0.260684003 ubox
12 26 0.009114446 ubox
12 28 0.014415449 ubox
12 31 0.029712645 ubox
12 40 0.069199276 ubox
12 41 0.004799512 ubox
12 63 0.779903587 ubox
12 64 0.018660268 ubox
12 65 0.019815003 ubox
12 66 0.051301388 ubox
12 68 0.603231641 ubox
13 25 0.008899169 ubox
13 27 0.014210421 ubox
13 30 0.015664880 ubox
13 39 0.074636282 ubox
13 59 0.004932843 ubox
13 62 0.781219673 ubox
13 67 0.593710898 ubox
13 69 0.013729660 ubox
14 25 0.010380906 ubox
14 29 0.015390182 ubox
14 30 0.038112956 ubox
14 38 0.077578424 ubox
14 58 0.005129357 ubox
14 61 0.781499480 ubox
14 67 0.061262771 ubox
15 23 0.016459918 ubox
15 27 0.005056324 ubox
15 29 0.038327808 ubox
15 38 0.018230107 ubox
15 57 0.005143547 ubox
15 60 0.780311364 ubox
15 61 0.003299013 ubox
15 67 0.068041560 ubox
16 22 0.016937132 ubox
16 26 0.004320729 ubox
16 28 0.038311986 ubox
16 35 0.015287424 ubox
16 36 0.742454360 ubox
16 54 0.007514099 ubox
16 56 0.004961358 ubox
16 63 0.072613767 ubox
16 64 0.578328252 ubox
16 65 0.019401907 ubox
16 66 0.069937687 ubox
17 21 0.016665848 ubox
17 24 0.003605846 ubox
17 26 0.044855180 ubox
17 35 0.779641670 ubox
17 36 0.003798775 ubox
17 53 0.007699619 ubox
17 63 0.590616087 ubox
17 64 0.010744228 ubox
17 65 0.061992697 ubox
17 66 0.004640144 ubox
18 23 0.003881377 ubox
18 25 0.044967719 ubox
18 34 0.779964152 ubox
18 52 0.007857380 ubox
18 60 0.007797152 ubox
18 61 0.616279514 ubox
19 32 0.020161941 ubox
19 33 0.778863313 ubox
19 59 0.008113395 ubox
19 60 0.616152584 ubox
20 32 0.772468924 ubox
20 33 0.003800210 ubox
20 50 0.003345455 ubox
20 59 0.623226558 ubox
20 62 0.010702984 ubox
21 29 0.003172838 ubox
21 30 0.779336302 ubox
21 49 0.003903908 ubox
21 50 0.007987468 ubox
21 58 0.623712597 ubox
21 61 0.010954378 ubox
22 29 0.779440960 ubox
22 30 0.019747990 ubox
22 49 0.007990591 ubox
22 57 0.623703972 ubox
22 60 0.010940485 ubox
23 28 0.759271181 ubox
23 31 0.013137500 ubox
23 47 0.007500918 ubox
23 48 0.005086930 ubox
23 56 0.623646845 ubox
24 30 0.013108480 ubox
24 32 0.012233597 ubox
24 46 0.007724132 ubox
24 55 0.622672372 ubox
24 59 0.008920033 ubox
25 31 0.014912083 ubox
25 35 0.011586236 ubox
25 43 0.005099486 ubox
25 44 0.036642459 ubox
25 47 0.011176380 ubox
25 51 0.010153639 ubox
25 53 0.085310245 ubox
25 54 0.606241951 ubox
26 30 0.014861755 ubox
26 34 0.011946472 ubox
26 38 0.005169559 ubox
26 42 0.005705206 ubox
26 45 0.118770297 ubox
26 49 0.020581051 ubox
26 50 0.018888166 ubox
26 52 0.436268401 ubox
26 57 0.011039704 ubox
27 31 0.003169107 ubox
27 35 0.103700419 ubox
27 41 0.005535698 ubox
27 43 0.130177994 ubox
27 44 0.119354435 ubox
27 47 0.030748552 ubox
27 48 0.011745433 ubox
27 51 0.412386019 ubox
27 53 0.375131743 ubox
27 54 0.004846471 ubox
27 56 0.011566998 ubox
27 68 0.007131640 ubox
28 34 0.103901531 ubox
28 38 0.003873037 ubox
28 42 0.181815801 ubox
28 45 0.067689667 ubox
28 49 0.179251692 ubox
28 50 0.372282754 ubox
28 52 0.378314628 ubox
28 67 0.007143085 ubox
29 35 0.015096632 ubox
29 36 0.013597131 ubox
29 40 0.007496291 ubox
29 41 0.190525305 ubox
29 44 0.110844284 ubox
29 47 0.029045527 ubox
29 48 0.242703381 ubox
29 51 0.348007271 ubox
29 53 0.007937375 ubox
29 54 0.069137902 ubox
29 66 0.007072585 ubox
30 35 0.014371384 ubox
30 40 0.190427203 ubox
30 43 0.111026988 ubox
30 44 0.003618100 ubox
30 47 0.256794393 ubox
30 48 0.216050590 ubox
30 51 0.031158469 ubox
30 53 0.129862526 ubox
30 54 0.004197849 ubox
30 65 0.005528624 ubox
30 68 0.007270700 ubox
31 38 0.174733563 ubox
31 42 0.111388826 ubox
31 45 0.150022154 ubox
31 49 0.346381239 ubox
31 50 0.040644167 ubox
31 52 0.130241730 ubox
31 67 0.007336999 ubox
32 36 0.009797121 ubox
32 43 0.015037976 ubox
32 48 0.314216643 ubox
32 51 0.074783454 ubox
32 53 0.018752440 ubox
32 65 0.013363263 ubox
33 43 0.035617853 ubox
33 48 0.141139467 ubox
33 51 0.016122923 ubox
33 53 0.005804756 ubox
33 64 0.015594164 ubox
34 40 0.026361564 ubox
34 41 0.046285293 ubox
34 43 0.328230795 ubox
34 44 0.167415406 ubox
34 47 0.195567880 ubox
34 48 0.005659956 ubox
34 51 0.194132089 ubox
34 53 0.006688722 ubox
34 63 0.015840697 ubox
34 68 0.007368033 ubox
35 42 0.370093614 ubox
35 45 0.255002078 ubox
35 49 0.010617007 ubox
35 50 0.219556497 ubox
35 52 0.006705713 ubox
35 60 0.003912738 ubox
35 61 0.015911909 ubox
35 67 0.007367045 ubox
36 42 0.031346342 ubox
36 45 0.047881324 ubox
36 46 0.055661896 ubox
36 49 0.222209817 ubox
36 59 0.008325362 ubox
36 60 0.015855041 ubox
36 62 0.004404442 ubox
37 43 0.114629906 ubox
37 48 0.223028708 ubox
37 53 0.052313153 ubox
37 64 0.007840500 ubox
38 43 0.021548865 ubox
38 44 0.197550464 ubox
38 47 0.223435227 ubox
38 51 0.003346786 ubox
38 53 0.004421521 ubox
38 54 0.012880430 ubox
38 63 0.008122288 ubox
38 66 0.009261022 ubox
39 43 0.172288235 ubox
39 51 0.106323085 ubox
39 53 0.013090956 ubox
39 65 0.009160770 ubox
40 45 0.097364065 ubox
40 49 0.003766928 ubox
40 50 0.109179791 ubox
40 52 0.012879761 ubox
40 57 0.003719556 ubox
40 58 0.774509419 ubox
40 61 0.005557056 ubox
41 45 0.014238284 ubox
41 49 0.109338835 ubox
41 50 0.012334308 ubox
41 57 0.778715218 ubox
41 58 0.004842726 ubox
41 60 0.005699888 ubox
41 61 0.003495616 ubox
42 47 0.024071393 ubox
42 48 0.089605570 ubox
42 51 0.003560502 ubox
42 56 0.778765696 ubox
42 63 0.057918559 ubox
43 50 0.007305968 ubox
43 55 0.774668475 ubox
43 58 0.005352623 ubox
43 59 0.003990676 ubox
43 62 0.058041904 ubox
44 49 0.024113098 ubox
44 50 0.014950201 ubox
44 52 0.006592869 ubox
44 57 0.005547864 ubox
44 58 0.004031068 ubox
44 61 0.058088003 ubox
45 51 0.005852898 ubox
45 53 0.006375262 ubox
45 54 0.783979112 ubox
45 56 0.003682198 ubox
46 51 0.003508534 ubox
46 53 0.785669377 ubox
47 52 0.785397279 ubox
47 58 0.058151714 ubox
48 57 0.058153683 ubox
48 67 0.003889332 ubox
49 54 0.004498111 ubox
49 56 0.058135360 ubox
49 66 0.005674875 ubox
50 54 0.005202169 ubox
50 65 0.004853839 ubox
52 63 0.007492104 ubox
53 62 0.007514922 ubox
54 61 0.007504578 ubox
56 67 0.019551307 ubox
57 66 0.020344402 ubox
58 65 0.019963708 ubox
58 66 0.024021517 ubox
58 68 0.005150902 ubox
59 64 0.018628520 ubox
59 65 0.023758194 ubox
60 64 0.016154479 ubox
60 66 0.015873803 ubox
60 68 0.014314635 ubox
61 65 0.010354264 ubox
61 66 0.016338700 ubox
61 68 0.009497361 ubox
63 67 0.003604575 ubox
64 69 0.003337970 ubox
64 70 0.004677629 ubox
65 69 0.004586104 ubox
71 78 0.004129173 ubox
72 79 0.022902976 ubox
73 78 0.024667116 ubox
1 78 0.9500000 lbox
2 77 0.9500000 lbox
3 76 0.9500000 lbox
4 75 0.9500000 lbox
5 74 0.9500000 lbox
6 73 0.9500000 lbox
7 72 0.9500000 lbox
8 71 0.9500000 lbox
9 68 0.9500000 lbox
10 67 0.9500000 lbox
12 63 0.9500000 lbox
13 62 0.9500000 lbox
14 61 0.9500000 lbox
15 60 0.9500000 lbox
16 36 0.9500000 lbox
17 35 0.9500000 lbox
18 34 0.9500000 lbox
19 33 0.9500000 lbox
20 32 0.9500000 lbox
21 30 0.9500000 lbox
22 29 0.9500000 lbox
23 28 0.9500000 lbox
40 58 0.9500000 lbox
41 57 0.9500000 lbox
42 56 0.9500000 lbox
43 55 0.9500000 lbox
45 54 0.9500000 lbox
46 53 0.9500000 lbox
47 52 0.9500000 lbox
showpage
end
%%EOF
