%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Mon Jun 15 13:50:52 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (292)
} def

/sequence { (\
GGAAAAAAGUGCAAGUACAAAAGUACAGACAGCUGAAAGUGGCAAAAGGCACGCAGAGGUCAAGCACAGUGUUACUUCG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 12 0.017042629 ubox
1 67 0.003541833 ubox
1 70 0.004295863 ubox
1 72 0.014556512 ubox
1 73 0.025908423 ubox
1 75 0.231818843 ubox
1 76 0.167568478 ubox
1 77 0.013818367 ubox
1 78 0.252783302 ubox
2 12 0.004147950 ubox
2 70 0.007022638 ubox
2 72 0.028734659 ubox
2 73 0.116031231 ubox
2 75 0.193092422 ubox
2 76 0.015314710 ubox
2 77 0.249874046 ubox
2 78 0.250714325 ubox
3 10 0.014781754 ubox
3 70 0.023093193 ubox
3 72 0.118382748 ubox
3 73 0.219335505 ubox
3 76 0.235037662 ubox
3 77 0.249169341 ubox
4 70 0.037228245 ubox
4 72 0.263259028 ubox
4 73 0.193391142 ubox
4 76 0.219003462 ubox
4 77 0.010967841 ubox
5 70 0.040071301 ubox
5 72 0.208121631 ubox
5 73 0.150276630 ubox
5 76 0.011980010 ubox
5 77 0.006977265 ubox
6 70 0.227494894 ubox
6 72 0.159195846 ubox
6 73 0.081163904 ubox
6 76 0.006642074 ubox
6 77 0.009442158 ubox
7 34 0.004162298 ubox
7 70 0.076306258 ubox
7 72 0.077008815 ubox
7 73 0.121511489 ubox
7 76 0.008453813 ubox
7 77 0.110494344 ubox
8 34 0.033482688 ubox
8 70 0.076726265 ubox
8 72 0.123319808 ubox
8 73 0.018648253 ubox
8 76 0.126005347 ubox
8 77 0.005200933 ubox
9 18 0.005862665 ubox
9 26 0.034818970 ubox
9 30 0.009910877 ubox
9 33 0.034813898 ubox
9 52 0.021794345 ubox
9 65 0.004147253 ubox
9 67 0.982295610 ubox
9 70 0.008685334 ubox
9 72 0.007339400 ubox
9 75 0.128458466 ubox
9 78 0.006585644 ubox
10 17 0.005800720 ubox
10 25 0.034861111 ubox
10 29 0.009878140 ubox
10 31 0.014908442 ubox
10 32 0.032388603 ubox
10 51 0.021829186 ubox
10 55 0.008060510 ubox
10 64 0.003942675 ubox
10 66 0.984101242 ubox
10 68 0.017358221 ubox
10 71 0.009909983 ubox
10 74 0.125717821 ubox
10 79 0.027700302 ubox
11 16 0.004946770 ubox
11 24 0.034880953 ubox
11 30 0.017748756 ubox
11 33 0.007847013 ubox
11 50 0.021848764 ubox
11 54 0.008947751 ubox
11 65 0.984791501 ubox
11 67 0.016796698 ubox
11 70 0.017576893 ubox
11 72 0.078421596 ubox
11 73 0.090153105 ubox
11 78 0.047256416 ubox
12 23 0.034868143 ubox
12 28 0.010833744 ubox
12 32 0.007852516 ubox
12 49 0.021796110 ubox
12 53 0.008940096 ubox
12 64 0.983773335 ubox
12 69 0.018289823 ubox
12 71 0.108710133 ubox
12 79 0.010694851 ubox
13 70 0.097411990 ubox
13 72 0.005121682 ubox
13 77 0.061932801 ubox
14 24 0.003564817 ubox
14 70 0.006632688 ubox
14 76 0.065599992 ubox
15 26 0.995259613 ubox
15 75 0.066073485 ubox
16 21 0.003302506 ubox
16 22 0.003798322 ubox
16 25 0.996454271 ubox
16 71 0.003664787 ubox
16 74 0.065337415 ubox
17 24 0.996415389 ubox
17 70 0.004236725 ubox
17 72 0.046879587 ubox
17 73 0.047122807 ubox
18 23 0.994696082 ubox
18 69 0.004455340 ubox
18 71 0.064999601 ubox
19 70 0.063980334 ubox
20 70 0.009658885 ubox
21 77 0.007319275 ubox
22 76 0.008141474 ubox
23 65 0.035026111 ubox
23 67 0.024104881 ubox
23 75 0.008257883 ubox
24 63 0.004054131 ubox
24 64 0.034260503 ubox
24 66 0.023784445 ubox
24 74 0.008158396 ubox
25 72 0.005541536 ubox
25 73 0.005940372 ubox
26 35 0.005160688 ubox
26 64 0.017949633 ubox
26 71 0.007623990 ubox
27 34 0.007316134 ubox
27 70 0.007544201 ubox
28 33 0.007490427 ubox
28 61 0.997151520 ubox
28 73 0.004603490 ubox
29 60 0.998251220 ubox
29 72 0.004946072 ubox
30 41 0.003174651 ubox
30 58 0.005595135 ubox
30 59 0.998302211 ubox
30 71 0.004974911 ubox
31 60 0.007375771 ubox
31 70 0.004246116 ubox
32 43 0.022169399 ubox
32 54 0.005350849 ubox
32 60 0.012247497 ubox
32 61 0.003490784 ubox
32 65 0.006454892 ubox
33 39 0.003283620 ubox
33 42 0.022189274 ubox
33 53 0.005364279 ubox
33 56 0.997662076 ubox
33 58 0.032816155 ubox
33 59 0.013176885 ubox
33 64 0.006460937 ubox
33 69 0.004630868 ubox
34 41 0.021517477 ubox
34 55 0.997268523 ubox
34 56 0.004149041 ubox
34 57 0.032916391 ubox
34 58 0.013161456 ubox
34 62 0.005197968 ubox
34 63 0.004689148 ubox
34 68 0.004636412 ubox
34 79 0.010736965 ubox
35 40 0.011968636 ubox
35 54 0.990623714 ubox
35 61 0.006949474 ubox
35 67 0.004610908 ubox
35 78 0.031842382 ubox
36 60 0.006911864 ubox
36 77 0.026006464 ubox
37 76 0.018278988 ubox
37 77 0.026195558 ubox
38 76 0.033318856 ubox
39 50 0.064701048 ubox
39 52 0.990335072 ubox
39 54 0.043936901 ubox
39 75 0.038301453 ubox
40 47 0.004188686 ubox
40 48 0.003192258 ubox
40 49 0.064646672 ubox
40 51 0.993577419 ubox
40 53 0.052641955 ubox
40 62 0.003799224 ubox
40 74 0.038291465 ubox
41 50 0.989755970 ubox
41 52 0.052886888 ubox
41 61 0.003870988 ubox
41 73 0.038228541 ubox
42 50 0.116891431 ubox
42 60 0.003867532 ubox
42 72 0.038283084 ubox
43 48 0.945315495 ubox
43 49 0.147290732 ubox
43 59 0.003864890 ubox
43 71 0.038302998 ubox
44 70 0.037852447 ubox
48 61 0.007218429 ubox
48 67 0.005676896 ubox
49 60 0.007269993 ubox
49 65 0.037909099 ubox
50 59 0.007277915 ubox
50 64 0.037893391 ubox
51 60 0.027947473 ubox
52 58 0.005995870 ubox
52 59 0.028261094 ubox
53 60 0.018720038 ubox
53 61 0.008171465 ubox
53 65 0.003178347 ubox
54 58 0.003273191 ubox
54 59 0.020364810 ubox
54 64 0.003179938 ubox
56 78 0.029293822 ubox
57 77 0.029347865 ubox
58 76 0.029366484 ubox
59 75 0.029396710 ubox
60 74 0.028401865 ubox
62 70 0.003169747 ubox
62 72 0.003889879 ubox
62 73 0.008743827 ubox
62 77 0.034995428 ubox
63 70 0.006935049 ubox
63 72 0.008560638 ubox
63 73 0.063697994 ubox
63 76 0.040163194 ubox
64 70 0.016215641 ubox
64 72 0.079072449 ubox
64 75 0.041126538 ubox
65 69 0.017795830 ubox
65 71 0.080199757 ubox
66 70 0.065013584 ubox
66 72 0.008287312 ubox
66 73 0.044965210 ubox
67 71 0.008874568 ubox
68 72 0.007845194 ubox
68 73 0.017558557 ubox
68 76 0.256744035 ubox
68 77 0.028410986 ubox
69 73 0.010792375 ubox
69 75 0.278090225 ubox
69 76 0.026161830 ubox
69 77 0.015655053 ubox
69 78 0.102186255 ubox
70 74 0.250660025 ubox
70 79 0.085624678 ubox
71 75 0.009190290 ubox
71 76 0.021193947 ubox
71 77 0.018954698 ubox
71 78 0.146818727 ubox
72 79 0.008222856 ubox
73 79 0.007618164 ubox
75 79 0.015160527 ubox
9 67 0.9500000 lbox
10 66 0.9500000 lbox
11 65 0.9500000 lbox
12 64 0.9500000 lbox
15 26 0.9500000 lbox
16 25 0.9500000 lbox
17 24 0.9500000 lbox
18 23 0.9500000 lbox
28 61 0.9500000 lbox
29 60 0.9500000 lbox
30 59 0.9500000 lbox
33 56 0.9500000 lbox
34 55 0.9500000 lbox
35 54 0.9500000 lbox
39 52 0.9500000 lbox
40 51 0.9500000 lbox
41 50 0.9500000 lbox
43 48 0.9500000 lbox
showpage
end
%%EOF
