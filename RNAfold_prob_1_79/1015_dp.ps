%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Mon Jun 15 13:50:42 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (1015)
} def

/sequence { (\
GGAAAACGCAAAGCGAAGUACAAAGUACAAAUGACAAAGUCAUAACAGCAAAGCUGAAGCCAAAGGCAAGGAUAAUUCG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 7 0.082523089 ubox
1 9 0.050992805 ubox
1 14 0.012980797 ubox
1 21 0.032502677 ubox
1 46 0.005633120 ubox
1 55 0.003974935 ubox
1 60 0.003508283 ubox
1 61 0.096782899 ubox
1 67 0.010942932 ubox
1 73 0.011849976 ubox
1 76 0.007816299 ubox
1 77 0.013442104 ubox
1 78 0.514436132 ubox
2 7 0.032626083 ubox
2 9 0.029627598 ubox
2 14 0.006676154 ubox
2 19 0.005794328 ubox
2 21 0.009806390 ubox
2 41 0.003801657 ubox
2 54 0.004186206 ubox
2 60 0.096539801 ubox
2 61 0.006156509 ubox
2 67 0.007443064 ubox
2 73 0.012880921 ubox
2 76 0.013775256 ubox
2 77 0.498420411 ubox
2 78 0.737507935 ubox
3 19 0.014589955 ubox
3 40 0.003553669 ubox
3 73 0.020148463 ubox
3 76 0.461552275 ubox
3 77 0.728606886 ubox
4 19 0.005029064 ubox
4 73 0.034372711 ubox
4 76 0.633534643 ubox
4 77 0.047596463 ubox
5 19 0.006572731 ubox
5 73 0.045932648 ubox
5 76 0.053125402 ubox
5 77 0.030557320 ubox
6 19 0.012216911 ubox
6 26 0.008536265 ubox
6 40 0.003435282 ubox
6 73 0.056865275 ubox
6 76 0.030956608 ubox
6 77 0.013111146 ubox
7 13 0.056841396 ubox
7 15 0.922958352 ubox
7 18 0.012168709 ubox
7 25 0.008806651 ubox
7 39 0.003654635 ubox
7 56 0.004429960 ubox
7 65 0.003443929 ubox
7 66 0.003290910 ubox
7 70 0.046116786 ubox
7 71 0.040149484 ubox
7 79 0.035274019 ubox
8 14 0.944429916 ubox
8 19 0.014020327 ubox
8 26 0.004661248 ubox
8 49 0.007209797 ubox
8 54 0.017227585 ubox
8 60 0.013247701 ubox
8 67 0.029403337 ubox
8 73 0.005906588 ubox
8 78 0.029357630 ubox
9 13 0.937645583 ubox
9 15 0.027400999 ubox
9 18 0.014536151 ubox
9 25 0.004809181 ubox
9 48 0.007210198 ubox
9 53 0.017257845 ubox
9 59 0.013335780 ubox
9 66 0.029380010 ubox
9 70 0.049617270 ubox
9 71 0.045574205 ubox
9 79 0.010618270 ubox
10 76 0.007790382 ubox
10 77 0.015164281 ubox
11 73 0.005417668 ubox
11 76 0.013508027 ubox
11 77 0.006223598 ubox
12 55 0.014637440 ubox
12 73 0.004632222 ubox
12 76 0.006129013 ubox
12 77 0.004178264 ubox
13 19 0.007823060 ubox
13 26 0.014970630 ubox
13 49 0.017781759 ubox
13 54 0.015166188 ubox
13 60 0.027184247 ubox
13 61 0.003500631 ubox
13 67 0.026197476 ubox
13 73 0.004355777 ubox
13 76 0.003727629 ubox
13 78 0.007321492 ubox
14 18 0.007971440 ubox
14 25 0.015346838 ubox
14 33 0.003646477 ubox
14 48 0.017782603 ubox
14 53 0.015150674 ubox
14 59 0.027308453 ubox
14 66 0.026168517 ubox
14 70 0.018429308 ubox
14 71 0.017498132 ubox
14 79 0.246734564 ubox
15 21 0.005066744 ubox
15 28 0.004497956 ubox
15 32 0.003423861 ubox
15 46 0.004420014 ubox
15 60 0.003957041 ubox
15 77 0.007695386 ubox
15 78 0.274561208 ubox
16 32 0.007378316 ubox
16 73 0.010603401 ubox
16 76 0.011330347 ubox
16 77 0.271353038 ubox
17 26 0.013586272 ubox
17 32 0.003913898 ubox
17 55 0.004977985 ubox
17 73 0.010469548 ubox
17 76 0.236147307 ubox
17 77 0.012015629 ubox
18 26 0.003447813 ubox
18 28 0.988622976 ubox
18 35 0.003632326 ubox
18 54 0.005087453 ubox
18 73 0.010293567 ubox
18 76 0.007940424 ubox
18 78 0.003673701 ubox
19 24 0.010764465 ubox
19 25 0.004185143 ubox
19 27 0.989764612 ubox
19 34 0.003603453 ubox
19 53 0.004968037 ubox
19 72 0.010022472 ubox
19 74 0.020160050 ubox
19 75 0.008533722 ubox
20 26 0.989003999 ubox
20 73 0.020897031 ubox
21 25 0.979360341 ubox
21 33 0.003567805 ubox
21 70 0.016075894 ubox
21 71 0.016760548 ubox
21 79 0.005387547 ubox
22 26 0.003179985 ubox
22 32 0.003309941 ubox
24 77 0.005647960 ubox
25 35 0.004846473 ubox
25 46 0.003814557 ubox
25 49 0.008706422 ubox
25 73 0.007339148 ubox
25 76 0.006549956 ubox
25 78 0.003515730 ubox
26 34 0.004773376 ubox
26 44 0.004111994 ubox
26 45 0.003956439 ubox
26 48 0.008549289 ubox
26 72 0.007092944 ubox
26 74 0.003916750 ubox
26 75 0.006442521 ubox
27 43 0.003333652 ubox
27 73 0.004024506 ubox
28 33 0.003614977 ubox
28 70 0.011049492 ubox
28 71 0.006495407 ubox
28 79 0.005936564 ubox
29 43 0.015971493 ubox
29 73 0.005098520 ubox
29 76 0.003498802 ubox
29 77 0.007723536 ubox
30 43 0.043693931 ubox
30 73 0.005995348 ubox
30 76 0.007701825 ubox
30 77 0.005990125 ubox
31 40 0.008617655 ubox
31 43 0.943933790 ubox
31 73 0.003753165 ubox
31 76 0.004864902 ubox
32 37 0.004338962 ubox
32 38 0.004050197 ubox
32 39 0.008886691 ubox
32 42 0.985310942 ubox
32 44 0.004465022 ubox
32 72 0.003510987 ubox
32 75 0.004399533 ubox
32 79 0.005964760 ubox
33 41 0.998446241 ubox
33 78 0.009589278 ubox
34 40 0.997163834 ubox
34 77 0.009318938 ubox
35 39 0.987294304 ubox
38 43 0.003828571 ubox
39 73 0.016314177 ubox
40 71 0.003541321 ubox
40 72 0.016776477 ubox
41 70 0.004144038 ubox
41 71 0.016801915 ubox
43 57 0.011743027 ubox
43 58 0.014881246 ubox
43 59 0.006255843 ubox
43 69 0.003437318 ubox
43 74 0.003916506 ubox
44 73 0.005399895 ubox
44 77 0.003209189 ubox
45 73 0.003944796 ubox
45 76 0.003313275 ubox
46 53 0.009651204 ubox
46 56 0.992937030 ubox
46 70 0.003569714 ubox
47 55 0.997214222 ubox
48 54 0.997870443 ubox
48 67 0.009677191 ubox
49 53 0.990620043 ubox
49 56 0.019139641 ubox
49 66 0.009674299 ubox
49 71 0.004359614 ubox
50 55 0.017297093 ubox
51 73 0.005250705 ubox
52 73 0.005950373 ubox
53 60 0.009574079 ubox
53 67 0.014612931 ubox
53 73 0.005307175 ubox
54 59 0.009623957 ubox
54 65 0.004591373 ubox
54 66 0.014470074 ubox
54 70 0.018077420 ubox
54 71 0.029407974 ubox
55 62 0.003808114 ubox
55 64 0.005060537 ubox
55 65 0.013948821 ubox
55 69 0.017981499 ubox
55 70 0.029432900 ubox
55 71 0.005420755 ubox
55 79 0.003628117 ubox
56 61 0.004711962 ubox
56 78 0.008973090 ubox
57 73 0.010832699 ubox
57 76 0.003264621 ubox
57 77 0.009635548 ubox
58 73 0.033251751 ubox
58 76 0.009508952 ubox
59 67 0.977591895 ubox
59 73 0.028842023 ubox
60 65 0.010668255 ubox
60 66 0.978585795 ubox
60 70 0.004192290 ubox
60 71 0.164435547 ubox
61 65 0.971479754 ubox
61 66 0.010166142 ubox
61 70 0.164974431 ubox
61 71 0.005885360 ubox
64 73 0.005705668 ubox
65 73 0.003306639 ubox
65 78 0.006696272 ubox
66 77 0.005429115 ubox
66 78 0.007173427 ubox
67 71 0.005716705 ubox
67 79 0.003189060 ubox
68 73 0.033372224 ubox
68 76 0.010461636 ubox
68 77 0.034230708 ubox
69 73 0.024124477 ubox
69 76 0.050373631 ubox
69 77 0.019411603 ubox
70 76 0.031300141 ubox
70 77 0.011894822 ubox
70 78 0.076318865 ubox
71 76 0.012525493 ubox
71 77 0.074672588 ubox
71 78 0.184977199 ubox
72 76 0.064445347 ubox
72 77 0.181595048 ubox
2 78 0.9500000 lbox
3 77 0.9500000 lbox
4 76 0.9500000 lbox
7 15 0.9500000 lbox
8 14 0.9500000 lbox
9 13 0.9500000 lbox
18 28 0.9500000 lbox
19 27 0.9500000 lbox
20 26 0.9500000 lbox
21 25 0.9500000 lbox
31 43 0.9500000 lbox
32 42 0.9500000 lbox
33 41 0.9500000 lbox
34 40 0.9500000 lbox
35 39 0.9500000 lbox
46 56 0.9500000 lbox
47 55 0.9500000 lbox
48 54 0.9500000 lbox
49 53 0.9500000 lbox
59 67 0.9500000 lbox
60 66 0.9500000 lbox
61 65 0.9500000 lbox
showpage
end
%%EOF
