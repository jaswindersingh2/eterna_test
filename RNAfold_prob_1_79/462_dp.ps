%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Mon Jun 15 13:50:58 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (462)
} def

/sequence { (\
GGAAAAGUACACGACAGUGGAAACACGAGGAAACUCGUCAAAACAUGUGGAAACACAUGGUGUACAAAGGUUGGAUUCG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 10 0.008948069 ubox
1 65 0.004727214 ubox
1 71 0.033383509 ubox
1 72 0.048062931 ubox
1 76 0.004773135 ubox
1 78 0.075034012 ubox
2 65 0.004271312 ubox
2 71 0.055390743 ubox
2 72 0.064666384 ubox
2 76 0.004055615 ubox
2 77 0.073722441 ubox
2 78 0.099695136 ubox
3 71 0.067275992 ubox
3 72 0.047786084 ubox
3 76 0.069295526 ubox
3 77 0.099006417 ubox
4 71 0.050879244 ubox
4 72 0.021426256 ubox
4 76 0.090476241 ubox
4 77 0.006727096 ubox
5 71 0.021628255 ubox
5 72 0.048066588 ubox
5 76 0.007848344 ubox
5 77 0.009252309 ubox
6 71 0.049043044 ubox
6 72 0.026915064 ubox
6 76 0.010971389 ubox
6 77 0.010626816 ubox
7 24 0.016651999 ubox
7 65 0.996168306 ubox
7 71 0.005403635 ubox
7 72 0.004469915 ubox
7 76 0.012439686 ubox
7 78 0.014653910 ubox
8 19 0.003448559 ubox
8 21 0.004674804 ubox
8 23 0.015772435 ubox
8 64 0.997789861 ubox
8 69 0.004722143 ubox
8 73 0.003351385 ubox
8 75 0.012786327 ubox
9 18 0.003866938 ubox
9 63 0.998100593 ubox
9 71 0.005129622 ubox
9 76 0.011651637 ubox
10 17 0.003910014 ubox
10 19 0.043056792 ubox
10 62 0.998308002 ubox
10 70 0.005128547 ubox
10 73 0.003709649 ubox
10 74 0.016436251 ubox
11 18 0.045279625 ubox
11 61 0.997556353 ubox
12 17 0.046191886 ubox
12 19 0.009925492 ubox
12 20 0.006475409 ubox
12 59 0.003442628 ubox
12 60 0.996424332 ubox
12 69 0.003307653 ubox
12 70 0.003310157 ubox
12 73 0.035512167 ubox
12 79 0.004227645 ubox
13 18 0.016930630 ubox
13 24 0.035019439 ubox
13 26 0.007706682 ubox
13 36 0.003619633 ubox
13 39 0.482652586 ubox
13 72 0.035674678 ubox
13 78 0.004435136 ubox
14 18 0.013418354 ubox
14 35 0.003486930 ubox
14 38 0.482627547 ubox
14 58 0.027339400 ubox
14 61 0.006884390 ubox
14 63 0.003882364 ubox
14 71 0.035717274 ubox
14 77 0.004130064 ubox
15 19 0.035521201 ubox
15 20 0.063125719 ubox
15 27 0.009898003 ubox
15 29 0.013379973 ubox
15 37 0.481625459 ubox
15 59 0.009483296 ubox
15 60 0.009344329 ubox
15 62 0.003950290 ubox
15 69 0.003515420 ubox
15 70 0.035529947 ubox
16 35 0.040715044 ubox
16 58 0.007046183 ubox
16 61 0.003548710 ubox
17 24 0.559108790 ubox
17 26 0.681756980 ubox
17 34 0.040814844 ubox
17 36 0.005640028 ubox
17 39 0.017556028 ubox
17 44 0.017540950 ubox
17 46 0.016862201 ubox
17 56 0.011223282 ubox
17 65 0.005822853 ubox
18 22 0.010073626 ubox
18 23 0.554285575 ubox
18 25 0.695018470 ubox
18 27 0.003924511 ubox
18 33 0.040294517 ubox
18 40 0.066953125 ubox
18 41 0.011309679 ubox
18 42 0.011192782 ubox
18 43 0.021649186 ubox
18 45 0.020539131 ubox
18 55 0.011245784 ubox
18 64 0.005852142 ubox
18 66 0.017897735 ubox
18 67 0.011785074 ubox
18 68 0.003925210 ubox
19 24 0.725596083 ubox
19 26 0.027440825 ubox
19 34 0.005497319 ubox
19 39 0.074101010 ubox
19 44 0.024555287 ubox
19 54 0.011230086 ubox
19 63 0.005474527 ubox
19 65 0.019723750 ubox
20 24 0.030708805 ubox
20 26 0.007417091 ubox
20 38 0.036362419 ubox
20 39 0.056766051 ubox
20 44 0.003746600 ubox
20 65 0.010689548 ubox
20 78 0.013054621 ubox
21 38 0.043407098 ubox
21 61 0.004397536 ubox
21 63 0.003925813 ubox
21 77 0.012947331 ubox
22 38 0.004518836 ubox
22 72 0.005884823 ubox
22 76 0.011618538 ubox
23 38 0.007854610 ubox
23 48 0.006900204 ubox
23 61 0.019377361 ubox
23 63 0.019613080 ubox
23 71 0.006461588 ubox
24 29 0.017952583 ubox
24 30 0.005015832 ubox
24 37 0.006709260 ubox
24 47 0.006943395 ubox
24 49 0.008182049 ubox
24 60 0.019528916 ubox
24 62 0.020443483 ubox
24 70 0.006492491 ubox
24 73 0.005167190 ubox
24 74 0.007379542 ubox
25 38 0.665017216 ubox
25 46 0.004694269 ubox
25 48 0.007456077 ubox
25 61 0.019191688 ubox
26 37 0.724638494 ubox
26 47 0.006796084 ubox
26 60 0.018698027 ubox
26 79 0.008631659 ubox
27 34 0.005939350 ubox
27 36 0.975328780 ubox
27 38 0.003900277 ubox
27 39 0.209725963 ubox
27 46 0.003889458 ubox
27 78 0.009483686 ubox
28 35 0.975679166 ubox
28 38 0.209435858 ubox
28 77 0.009465738 ubox
29 34 0.975008468 ubox
29 35 0.007060286 ubox
29 36 0.022635505 ubox
29 39 0.005720364 ubox
29 44 0.003712938 ubox
29 76 0.009259154 ubox
30 34 0.010394607 ubox
30 35 0.017822569 ubox
30 36 0.209275133 ubox
30 38 0.004882983 ubox
30 39 0.017660026 ubox
31 35 0.182144645 ubox
31 38 0.016708972 ubox
32 72 0.009380585 ubox
33 71 0.009516526 ubox
34 70 0.009515270 ubox
35 69 0.009127608 ubox
37 44 0.018458599 ubox
37 65 0.014046593 ubox
38 42 0.011604284 ubox
38 43 0.022586689 ubox
38 64 0.013849723 ubox
39 59 0.006681002 ubox
39 62 0.014701542 ubox
39 73 0.006623420 ubox
40 58 0.005559321 ubox
40 61 0.013884658 ubox
40 63 0.008048333 ubox
40 72 0.006614533 ubox
41 61 0.005963771 ubox
41 63 0.003487317 ubox
41 71 0.006370978 ubox
42 61 0.009505379 ubox
43 61 0.009876501 ubox
44 59 0.996676465 ubox
44 60 0.007605014 ubox
45 58 0.998650475 ubox
46 55 0.003241765 ubox
46 57 0.999197549 ubox
47 54 0.004024422 ubox
47 56 0.999877267 ubox
47 58 0.004923810 ubox
48 53 0.004104821 ubox
48 55 0.999635898 ubox
48 57 0.005304803 ubox
49 54 0.999174552 ubox
49 56 0.005569668 ubox
50 54 0.007365320 ubox
60 65 0.004810910 ubox
60 76 0.006264174 ubox
60 78 0.008152313 ubox
61 68 0.003184340 ubox
61 75 0.006904646 ubox
62 76 0.008024730 ubox
63 73 0.006723985 ubox
63 75 0.007481464 ubox
64 71 0.011637602 ubox
64 72 0.005459216 ubox
65 69 0.004116239 ubox
65 70 0.013739188 ubox
65 73 0.036086394 ubox
65 74 0.006902060 ubox
66 71 0.015057738 ubox
66 72 0.045977651 ubox
66 76 0.007263218 ubox
66 77 0.031545237 ubox
67 71 0.036443959 ubox
67 72 0.026442109 ubox
67 76 0.034559734 ubox
67 77 0.046708183 ubox
68 72 0.013816776 ubox
68 76 0.051018222 ubox
68 77 0.053094256 ubox
69 76 0.058650059 ubox
69 77 0.047276395 ubox
69 78 0.293772447 ubox
70 76 0.056555602 ubox
70 77 0.273335383 ubox
70 78 0.094567647 ubox
71 75 0.054543999 ubox
71 79 0.007177281 ubox
72 79 0.081342771 ubox
73 77 0.008164073 ubox
73 78 0.138068512 ubox
74 78 0.042404242 ubox
7 65 0.9500000 lbox
8 64 0.9500000 lbox
9 63 0.9500000 lbox
10 62 0.9500000 lbox
11 61 0.9500000 lbox
12 60 0.9500000 lbox
17 24 0.9500000 lbox
18 23 0.9500000 lbox
25 38 0.9500000 lbox
26 37 0.9500000 lbox
27 36 0.9500000 lbox
28 35 0.9500000 lbox
29 34 0.9500000 lbox
44 59 0.9500000 lbox
45 58 0.9500000 lbox
46 57 0.9500000 lbox
47 56 0.9500000 lbox
48 55 0.9500000 lbox
49 54 0.9500000 lbox
showpage
end
%%EOF
