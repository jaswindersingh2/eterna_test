%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.4.14
%%CreationDate: Mon Jun 15 13:50:56 2020
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  currentdict /cutpoint known {
    cutpoint 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (397)
} def

/sequence { (\
GGAAAAGAUUUAACGUGUUAUAAAGUAACACCAUGGAAACCAUGCAUUUGAAACAGAUGGUUGAAUUAGAUUAUGUUCG\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 11 0.004285729 ubox
1 14 0.011151876 ubox
1 67 0.003591049 ubox
1 71 0.015064027 ubox
1 72 0.035307888 ubox
1 74 0.035412305 ubox
1 76 0.015946277 ubox
1 77 0.008182338 ubox
1 78 0.235467874 ubox
2 10 0.005186246 ubox
2 11 0.010330626 ubox
2 67 0.009031333 ubox
2 71 0.037210477 ubox
2 72 0.149889290 ubox
2 74 0.019212530 ubox
2 76 0.011897079 ubox
2 77 0.234795654 ubox
2 78 0.245516979 ubox
3 9 0.005120575 ubox
3 10 0.010543437 ubox
3 11 0.005613309 ubox
3 66 0.007133004 ubox
3 67 0.010614768 ubox
3 71 0.149287126 ubox
3 72 0.073883930 ubox
3 74 0.024540090 ubox
3 76 0.230727858 ubox
3 77 0.245245820 ubox
4 9 0.008915626 ubox
4 10 0.005860361 ubox
4 11 0.008679415 ubox
4 66 0.007342965 ubox
4 67 0.014030006 ubox
4 71 0.074380817 ubox
4 72 0.106450641 ubox
4 74 0.026961544 ubox
4 76 0.231532463 ubox
4 77 0.010940097 ubox
5 9 0.004592817 ubox
5 10 0.007733316 ubox
5 66 0.009780914 ubox
5 67 0.021715597 ubox
5 71 0.112656808 ubox
5 72 0.105374170 ubox
5 74 0.079020264 ubox
5 76 0.013046283 ubox
5 77 0.013302167 ubox
6 66 0.015394872 ubox
6 67 0.043393100 ubox
6 71 0.109755281 ubox
6 72 0.049493629 ubox
6 74 0.093591263 ubox
6 76 0.015923468 ubox
6 77 0.006026746 ubox
7 14 0.006176310 ubox
7 62 0.005073885 ubox
7 66 0.034123482 ubox
7 67 0.934478979 ubox
7 71 0.029425073 ubox
7 72 0.185180403 ubox
7 74 0.013672815 ubox
7 76 0.003808428 ubox
7 77 0.005505759 ubox
7 78 0.014457530 ubox
8 61 0.005565480 ubox
8 66 0.969289537 ubox
8 67 0.019501197 ubox
8 71 0.194836552 ubox
8 72 0.014559576 ubox
8 74 0.007312890 ubox
8 76 0.005843432 ubox
8 77 0.012836439 ubox
9 37 0.009001241 ubox
9 60 0.005377640 ubox
9 64 0.004578903 ubox
9 65 0.974962985 ubox
9 68 0.007391045 ubox
9 69 0.004004403 ubox
9 70 0.194869588 ubox
9 73 0.005831722 ubox
9 75 0.005447574 ubox
10 36 0.009708159 ubox
10 37 0.003181640 ubox
10 63 0.003736380 ubox
10 64 0.977578756 ubox
10 65 0.005360845 ubox
10 69 0.193113845 ubox
10 70 0.005950581 ubox
11 35 0.009929253 ubox
11 36 0.003207154 ubox
11 63 0.978155073 ubox
11 64 0.004864805 ubox
11 68 0.190694674 ubox
11 69 0.005715593 ubox
11 73 0.004891405 ubox
12 34 0.009601989 ubox
12 62 0.978152545 ubox
12 66 0.004736591 ubox
12 67 0.187445285 ubox
12 72 0.004929302 ubox
12 77 0.007578805 ubox
13 61 0.978736624 ubox
13 62 0.003227756 ubox
13 66 0.154817229 ubox
13 67 0.003913207 ubox
13 71 0.004203892 ubox
13 76 0.008900524 ubox
14 59 0.004125754 ubox
14 60 0.978110010 ubox
14 63 0.038099743 ubox
14 75 0.009034695 ubox
14 79 0.004615025 ubox
15 29 0.004446377 ubox
15 31 0.996234121 ubox
15 32 0.009169852 ubox
15 62 0.003312914 ubox
15 74 0.004769575 ubox
16 28 0.004367706 ubox
16 30 0.998849475 ubox
16 73 0.004718334 ubox
17 29 0.999925998 ubox
17 72 0.004411286 ubox
18 27 0.006645502 ubox
18 28 0.999363100 ubox
19 24 0.003599161 ubox
19 25 0.004298865 ubox
19 27 0.998385616 ubox
19 28 0.004874658 ubox
20 26 0.991473925 ubox
21 25 0.917750751 ubox
21 27 0.007760935 ubox
21 68 0.003937441 ubox
22 26 0.008695335 ubox
22 67 0.003957997 ubox
23 66 0.003522722 ubox
26 63 0.004417436 ubox
27 62 0.004536892 ubox
28 61 0.004553240 ubox
29 60 0.004548487 ubox
31 44 0.005454073 ubox
32 44 0.989414636 ubox
33 43 0.997602061 ubox
33 66 0.003966491 ubox
34 42 0.998617438 ubox
34 65 0.004766002 ubox
35 40 0.021581973 ubox
35 41 0.999051747 ubox
36 40 0.982915402 ubox
36 41 0.010513682 ubox
38 62 0.022209972 ubox
39 61 0.023804557 ubox
40 60 0.024034677 ubox
41 59 0.023993995 ubox
41 63 0.013845959 ubox
42 58 0.023723117 ubox
42 62 0.013799079 ubox
43 57 0.022924369 ubox
44 61 0.004905980 ubox
45 50 0.008244553 ubox
45 56 0.009500871 ubox
45 59 0.995512909 ubox
45 60 0.009042114 ubox
45 63 0.003460506 ubox
46 58 0.997910671 ubox
46 62 0.003187519 ubox
46 66 0.004399738 ubox
46 71 0.004329214 ubox
47 53 0.004908063 ubox
47 56 0.005284589 ubox
47 57 0.998022090 ubox
47 65 0.005357080 ubox
47 70 0.004640622 ubox
48 52 0.004479512 ubox
48 55 0.006289474 ubox
48 56 0.997244346 ubox
48 57 0.013467711 ubox
48 64 0.005695094 ubox
48 65 0.004343909 ubox
48 69 0.004727922 ubox
49 53 0.003741933 ubox
49 55 0.994398342 ubox
49 56 0.017153339 ubox
49 63 0.005589892 ubox
49 64 0.004901703 ubox
49 65 0.003707264 ubox
49 68 0.004768089 ubox
49 79 0.004883727 ubox
50 54 0.979238065 ubox
50 62 0.004359889 ubox
50 67 0.004768639 ubox
50 78 0.008407291 ubox
51 61 0.004024092 ubox
51 62 0.004810356 ubox
51 66 0.004675111 ubox
51 77 0.007215208 ubox
52 61 0.003642467 ubox
52 62 0.010456518 ubox
52 76 0.004766625 ubox
52 77 0.005780105 ubox
53 61 0.011200757 ubox
53 76 0.007500392 ubox
54 59 0.010960321 ubox
54 60 0.011363603 ubox
54 63 0.007022922 ubox
54 75 0.008687454 ubox
55 62 0.006838494 ubox
55 74 0.007430186 ubox
55 76 0.004941282 ubox
56 61 0.005219578 ubox
57 74 0.008301858 ubox
58 73 0.010576385 ubox
59 72 0.011022676 ubox
60 66 0.007414935 ubox
60 67 0.003687879 ubox
60 71 0.014131801 ubox
61 65 0.007679970 ubox
61 70 0.014399038 ubox
62 69 0.014231220 ubox
62 73 0.004334785 ubox
62 79 0.032992274 ubox
63 72 0.004797675 ubox
63 78 0.063009284 ubox
64 71 0.004542310 ubox
64 77 0.063124871 ubox
65 71 0.003475037 ubox
65 72 0.003301085 ubox
65 74 0.006957248 ubox
65 76 0.063206148 ubox
66 70 0.003241183 ubox
66 73 0.007504918 ubox
66 75 0.062686697 ubox
67 73 0.009901953 ubox
67 75 0.016805240 ubox
67 79 0.006427370 ubox
68 72 0.012453587 ubox
68 74 0.032196799 ubox
68 76 0.017914350 ubox
68 77 0.023082716 ubox
69 74 0.007403540 ubox
69 76 0.023785084 ubox
69 77 0.070421661 ubox
69 78 0.537240279 ubox
70 74 0.016352975 ubox
70 76 0.076792724 ubox
70 77 0.530222151 ubox
71 75 0.073963504 ubox
71 79 0.005308727 ubox
72 79 0.009205547 ubox
73 77 0.006554483 ubox
74 79 0.008780509 ubox
7 67 0.9500000 lbox
8 66 0.9500000 lbox
9 65 0.9500000 lbox
10 64 0.9500000 lbox
11 63 0.9500000 lbox
12 62 0.9500000 lbox
13 61 0.9500000 lbox
14 60 0.9500000 lbox
15 31 0.9500000 lbox
16 30 0.9500000 lbox
17 29 0.9500000 lbox
18 28 0.9500000 lbox
19 27 0.9500000 lbox
20 26 0.9500000 lbox
21 25 0.9500000 lbox
32 44 0.9500000 lbox
33 43 0.9500000 lbox
34 42 0.9500000 lbox
35 41 0.9500000 lbox
36 40 0.9500000 lbox
45 59 0.9500000 lbox
46 58 0.9500000 lbox
47 57 0.9500000 lbox
48 56 0.9500000 lbox
49 55 0.9500000 lbox
50 54 0.9500000 lbox
showpage
end
%%EOF
